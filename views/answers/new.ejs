<%- include('../partials/header'); -%>

<div class="loader hidden">
  <img src="/Rolling.gif" alt="Loading..." />
</div>

<div class="container">
  <form class="AnwerForm">
    <h2><i class="fas fa-reply"></i> Post Your Answer</h2>
    
    <div class="form-group">
      <label for="title">Answer Title</label>
      <input type="text" name="title" id="title" placeholder="Create a title for your answer" required />
    </div>
    
    <div class="form-group">
      <label for="answer">Your Answer</label>
      <textarea name="answer" id="answer" rows="8" placeholder="Write your detailed answer here..." required></textarea>
    </div>
    
    <button type="submit" class="btn btn-lg w-full">
      <i class="fas fa-paper-plane"></i> Submit Answer
    </button>
  </form>
</div>

<script>
  const form = document.querySelector("form");
  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    
    //spinner activated
    const loader = document.querySelector(".loader");
    loader.className = "loader";

    //get values of title and content of answer.
    const title = form.title.value;
    const content = form.answer.value;
    try {
      const res = await fetch("/questions/<%= question._id %>/answer/new", {
        method: "POST",
        body: JSON.stringify({ title, content }),
        headers: { "Content-Type": "application/json" },
      });
      const data = await res.json();
      if (data.answerID) {
        location.assign(
          `/questions/<%= question._id %>/answer/show/${data.answerID}`
        );
      }
    } catch (err) {
      console.log(err);
    }
  });
</script>

<%- include('../partials/footer'); -%>